{% extends 'base.html' %}

{% block breadcrumb %}
<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="{{ url_for('games.index') }}">Games</a></li>
    <li class="breadcrumb-item active" aria-current="page">{{ game['title'] }}</li>
  </ol>
</nav>
{% endblock %}

{% block header %}
  
{% endblock %}

{% block content %}
<div class='row mt-3'>
  <div class='col-12'>
  
    <div class="card" style="">
      <div class="card-body">
        <h5 class="card-title">{{ game['title'] }}
        </h5>
        
        <div name="body" id="body">
          <p class="fs-4">{{ request.form['body'] or game['body'] }}</p>
        </div>
        
        <br/>
        <div class= "text-body-secondary" name="comment" id="comment">
          <p class="fs-4">{{ request.form['comment'] or game['comment'] }}</p>
        </div>
  
      </div>
      <div class="card-body">
        {% if g.user['id'] == game['author_id'] %}
        <a class="card-link" aria-current="page" href="{{ url_for('games.update', id=game['id']) }}">edit</a>
        <a class="card-link" href="{{ url_for('games.get_full_description', id=game['id']) }}">get full description</a>
        {% else %}
        <a class="card-link" href="{{ url_for('games.get_full_description', id=game['id']) }}">get full description</a>
        {% endif %}  
      </div>

    </div>
  
  </div>
</div>
    
<div class='row mt-3'>
  <div class='col-12'>

    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home-tab-pane" type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">Elements</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile-tab-pane" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">Links</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact-tab-pane" type="button" role="tab" aria-controls="contact-tab-pane" aria-selected="false">Tags</button>
      </li>
    </ul>
    <div class="tab-content" id="myTabContent">
      <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
        <table class="table table-hover">
          <tbody>
            <thead>
              <tr>
                <th scope="col">Previous Element</th>
                <th scope="col">Title</th>
                <th scope="col">Description</th>
                <th scope="col">Consist</th>
                <th scope="col">More...</th>          
              </tr>
            </thead>
            {% for game_element in game_elements %}
              {% if (game_element['parent_element_id'] == None or game_element['parent_element_id'] == '') %}
                <tr>
                    <td>
                      {% if game_element['previous_ge_description'] is not none %}
                      <p>{{ game_element['previous_ge_description'] }}</p>
                      {% endif %}
                    </td>
                    <td>
                      <p><a href="{{ url_for('blog.view', id=game_element['e_id']) }}">{{ game_element['title'] }}</a></p>
                    </td>
                    <td>
                      <p>{{ game_element['description'] }}</p>
                    </td>
                    
                    <td>
                      {% if game_element['consist_count'] == 1 %}
                      <p><a href="{{ url_for('games.view_game_elements_of_the_parent', game_id=game['id'], parent_id=game_element['ge_id']) }}?title={{game['title']}}&parent={{ game_element['title'] }}">1 element</a></p>
                      {% elif game_element['consist_count'] > 1 %}
                      <p><a href="{{ url_for('games.view_game_elements_of_the_parent', game_id=game['id'], parent_id=game_element['ge_id']) }}?title={{game['title']}}&parent={{ game_element['title'] }}">{{ game_element['consist_count'] }} elements</a></p>
                      {% else %}
                      <p/>
                      {% endif %}
                      
                    </td>
                    <td class="">
                      <a class="btn btn-primary btn-sm" href="{{ url_for('game_elements.view', ge_id=game_element['ge_id'], game_id=game['id']) }}">more...</a>
                    </td>
                    
                </tr>
              {% endif %}
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
        {% for link in links %}
            <article class="">
              <header>
                <div>
                  <a href="{{ link['title'] }}" target="_blank">
                    <p class="fs-4">{{ link['title'] }}</p>
                  </a>
                </div>
              </header>
            </article>
            {% if loop.last %}
            {% endif %}
          {% endfor %}
      </div>

      <div class="tab-pane fade" id="contact-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
        {% for tag in tags %}
            <article class="">
              <header>
                <div>
                  <a href="#" onclick="tagOnClick('{{ tag['title'] }}')">
                    <p class="fs-4">#{{ tag['title'] }}</p>
                  </a>
                </div>
              </header>
            </article>
          {% endfor %}
      </div>
    </div>

  </div>
</div>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C7QR1MW3WC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-C7QR1MW3WC');
</script>
<script>
  /*el = document.getElementById("body");
  el.innerHTML = "{{ (request.form['body'] or game['body']) }}";
  console.log("{{ (request.form['body'] or game['body']) }}");*/
</script>

{% endblock %}
