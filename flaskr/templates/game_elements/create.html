{% extends 'base.html' %}

{% block content %}
<form action="{{ url_for('game_elements.create') }}" method="post">
  <fieldset class="">

    <legend class="">New Game Element</legend>
    
    <label for="type_of_id" class="form-label">Type of ID</label>
    <select class="form-select mb-3" aria-label="Type of element ID" name="type_of_id" id="type_of_id" required>
      <option selected value="element">Element</option>
      <option value="game_element">Game element</option>
    </select>
    
    <label for="previous_ge_id" class="form-label">Previous Game Element ID</label>
    <input class="form-control mb-3" placeholder="previous_ge_id" name="previous_ge_id" id="previous_ge_id" value="{{ request.form['previous_ge_id'] }}">
    <label for="parent_element_id" class="form-label">Parent Game Element ID</label>
    <input class="form-control mb-3" placeholder="parent_ge_id" name="parent_element_id" id="parent_element_id" value="{{ parent_element_id or request.form['parent_element_id'] }}">
    
    <label for="element_id" class="form-label">Element or Game Element ID</label>
    
    <div class="input-group">
      <input class="form-control" placeholder="element_id or ge_id" name="element_id" id="element_id" value="{{ request.form['element_id'] }}" aria-describedby="selectElementBtn" required>
  
      <button type="button" class="btn btn-outline-secondary" id="selectElementBtn" data-bs-toggle="offcanvas" data-bs-target="#elementPanel">
        Select
      </button>      
    </div>
    <a href="#" class="" id="viewElementLink" target="_blank"></a>

    <div id="selectElementSidePanelToReplace"></div>
    <div class="offcanvas offcanvas-end" tabindex="-1" id="elementPanel" aria-labelledby="elementPanelLabel" style="width: 40%;">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="elementPanelLabel">Select an Element</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div id="elementsListForSelection" class="offcanvas-body p-0">
        <div id="searchBar" class="p-3">
          <div class="row g-3 align-items-center">
            <div class="col-auto">
              <input type="text" class="form-control" id="search_term" placeholder="Text to search..." name="search_term" value="{{ search_term }}">
            </div>
            <div class="col-auto">
              <button type="button" class="btn btn-primary" id="searchElementBtn">Search</button>
            </div>
            <div class="col-auto">
              <button type="button" class="btn btn-secondary" id="clearSearchElementBtn">Clear</button>
            </div>
          </div>
        </div>
        
        <div class="list-group list-group-flush" id="elementsList">
          <p class="p-3">Loading...</p>
        </div>
        <div class='row mt-2'>
          <nav aria-label="Pagination">
            <ul class="pagination">
              <li class="page-item"><a class="page-link" href="#" id="previous_page_btn">Previous</a></li>
              <li class="page-item"><a class="page-link" href="#" id="next_page_btn">Next</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </div>

    <input class="form-control mb-3 mt-3" placeholder="weight" name="ge_weight" id="ge_weight" value="{{ request.form['ge_weight'] }}">
    <input class="form-control mb-3" placeholder="link" name="ge_link" id="ge_link" value="{{ request.form['ge_link'] }}">
    <textarea class="form-control mb-3" rows=6 placeholder="description" name="description" id="description">{{ request.form['description'] }}</textarea>

    <input class="form-control mb-3" name="game_id" id="games_id" value="{{ request.args.get('game_id') }}">                

    <input class="btn btn-primary" type="submit" value="Add Element">
    
  </fieldset>
</form>

<script>
  currentPage = {{ currentPage }};
  selectURL = '{{ url_for("blog.get_elements_for_selection") }}'
</script>
<script src="{{ url_for('static', filename='js/select.js') }}"></script>
{% endblock %}
